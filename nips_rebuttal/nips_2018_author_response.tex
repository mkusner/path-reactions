\documentclass{article}

\usepackage{nips_2018_author_response}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography

\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}


\begin{document}
Thank you for taking the time to review our paper. \todo[]{started chucking experimental results down but need to work out how to phrase and present them}


We are grateful for your suggestions about improving the description of the model. We therefore have made a few changes to section 3.
In particular, we add a step-by-step description of the workflow and a new diagram, figure XXX\todo[inline]{add in this figure!}, to provide background on GGNN and how these can be used to provide graph and node embeddings to make this section clearer. 
In addition we have brought out of the supplementary material some details on more specific architecture choices and to have space to do so, we are grateful to R2's suggestion to move the more technical details of section 4 into the appendix.

To the more specific individual comments we respond to each reviewer below.

\paragraph{Reviewer 1}

\emph{(2) Why the present method is expected to perform better than WLDN in product prediction?}
\todo[]{grab more from google doc here}
We believe that Electro is much closer to the underlying physical reality of reaction mechanisms being composed of sequential electron redistribution steps, it provides the needed compositional and relational inductive bias, leading to better performance.

We add however, that aside from the improved product prediction performance, we believe that  (1) the interpretability provided by Electro by modelling the mechanism steps and (2) the avoidance of having to set up a somewhat more fragmented machine learning pipeline of predict-then-rank steps are also advantageous features of our model.

\emph{(3) How the present model compares to WLDN and seqtoseq in terms of runtime.}


The timings of the models are given in Table \ref{table:timings}. We shall include these in the paper.
 For Electro we use a beam width of ten. 
 Although the overall time is greater than the others, only 0.044 secs is used to compute the probabilities and the majority of the time (0.193 secs) is used using RDKIT to create intermediate molecules or derive features from them, an operation that is not currently parallelized across the different beams. 
 Instead as the whole predict operation for Electro only takes 0.428 secs on a CPU we take advantage of the embarrassingly parallel nature of the task across different reaction predictions when running Electro on the test set.
 If we are interested in only computing the log likelihood of a reaction (and so have access to all the intermediate steps), this takes 0.007 secs on a GPU for Electro.
 
 \todo[]{Can also add the fact we have less parameters.}
 
 

\begin{table}[h]
  \caption{Time taken in seconds to predict product from the initial reactant and reagent molecules.
  These have been run on a NVIDIA 1080 GPU, with the mean time taken over the first 500 items of the test set.
  * As no code is available for [14] we instead report the timings given in Section 6.2 of their paper.
  }
  \label{table:timings}
  \centering
  \begin{tabular}{llll}
    \toprule
    & Electro (Ours) & WLDN [5] & Seq2Seq [14]  \\
    \midrule
    Timing (secs) & 0.337   & 0.034 &  0.025*     \\
    \bottomrule
  \end{tabular}
\end{table}
\todo[inline]{Check wldn timings as they give 50ms in paper. Maybe they include the initial rdkit time.}

\paragraph{Reviewer 2}
\emph{Point i)}
The motivation of only including reagent context at the start is that this is often the most challenging decision, and that action steps after this have access to the previous atom as context, making it an easier task.
Qualitatively, when running Electro-lite on the separate validation set we would see that the model often had the most errors on the first step, and that after picking this first step the next stages would often be correctly predicted.
We have since tested a version of Electro where reagent information is fed in as context at each step. 
On the mechanism prediction task (Table 1) this gets a slightly improved top-1 accuracy of 78.4\% but a similar top-5 accuracy of 94.6\%.

%One of the nice features of the approach is that we can easily break down the loss (or equivalently the negative log likelihood) of each prediction our model makes. 
%Empirically we found that Elctro-lite on the first 500 items of the validation set obtained a median loss of 0.209 on predicting where to start, whereas the first add step (when applicable) would contribute a median loss of 0.002, highlighting the sometimes much poorer performance of this module.
%When testing Electro, its initial select module would get a median loss of 0.023, showing that the addition of reagents, greatly improves the prediction of this task.

\emph{Point iii)} 
Sorry for the confusion here. $\mathcal{A}â€™$ is the set of all atoms in all molecules, and equation 2 is used only for $r_\textrm{stop}$.
The dependency on $a_{t-1}$ comes about by the changes in the molecular graph, caused by action $a_{t-1}$. 
To clarify this, we will add equations for each of our predictors: $f_\textrm{start}$, $f_\textrm{add}$, $f_\textrm{remove}$.

\emph{Point v)}  

\emph{Point ii and iv)} Thanks for these comments, we hope these have been addressed by our discussion at the top.} 




\paragraph{Reviewer 3}
%\emph{"On one hand, theis paper includes several modelling ideas that might have the potential to indeed advance the field. On the other hand, from a chemical perspective the model is still rather limited, since only topological molecule descriptors are used, neglecting the influence of conformational changes."}
\emph{Point under EVALUATION, on significance)}
Thank you for recognizing and commending our modelling ideas. We agree conformational change information is certainly useful. So far, work at machine learning venues has yet to make use of these conformational change features for reaction prediction, but we aim to consider this in future work on more general reaction classes. That said, in this current work, our purely topological model is harnessing an extremely powerful arrow-pushing abstraction for chemists. It allows chemists to make very quick, but tremendously accurate predictions without doing any quantum simulations, and to understand relations between reaction classes, which is not possible using quantum mechanics alone. 


\end{document}
