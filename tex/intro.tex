% !TEX root =  ../main.tex
% reaction prediction is important
% currently it is an arduous process that requires a chemist
% cost
% human effort

The ability to reliably predict the products of chemical reactions is of tremendous importance for areas as diverse as health care, renewable energy, and construction, providing molecules which serve as medicines, energy capturing devices, and nanomaterials. 
When designing most new molecules, often a very experienced chemist with years of experience is needed, in order to make accurate predictions. 
If such predictions could be automated it could drastically speed up the discovery of new molecules for these applications, among many others. Recently, there have been a number of machine learning models proposed for predicting the product of chemical reactions \cite{coley2017prediction,jin2017predicting,schwaller2017found,neural-symbolic,segler2018planning,wei2016neural,zhang2005structure}, largely using graph-based or machine translation models. The general task of reaction prediction is shown on the left-hand side of Figure~\ref{fig:task-overview}.

Apart from reaction product prediction, another crucial aspect of chemical reactions is the \emph{reaction mechanism}. Theoretically, all chemical reactions can be described by the stepwise movement of electrons in molecules, called the reaction mechanism.
This can be treated at different levels of abstraction. On the lowest level, quantum-mechanical simulations of the  changes in electronic structure are calculated by approximately solving the Schr√∂dinger equation, which is computationally expensive for most systems of interest. 
On the other end, chemical reactions can be treated as rules that ``rewrite'' reactant molecules to products, which abstracts away the individual electron redistribution steps into a single transformation step. 
%While rules can be brittle, they allow to organize chemical knowledge by grouping reactions by these rules, which facilitates learning.
To combine the advantages of both approaches, chemists use a tremendously powerful model, which simplifies the stepwise electron shifts using sequences of arrows which indicate the path of electrons throughout molecular graphs \cite{herges1994organizing}. 
%Using this compositional abstraction, chemists are able to make predictions beyond the established global rules, and understand the underlying mechanism, with essentially just pencil and paper.
Understanding the reaction mechanism is crucial because it not only determines the products, but it allows one to understand the general trends inherent in reactions. This Further, many rules used by chemists to understand the product of complex reactions is based on the reaction mechanism.
%MATT: Marwin could you check me on this?


In this paper we propose a model to predict the reaction mechanism of a particular subset of organic reactions called \emph{elementary, heterolytic reactions} as shown in on the right-hand side of Figure~\ref{fig:task-overview} (we give more detail on these reactions in the following section). We argue that not only is our model more interpretable than product prediction models but it is easier to encode the constraints imposed by chemistry into it. We call our model \ourModel, as it directly predicts the path of electrons through molecules (the reaction mechanism). To train the model we devise a general technique to obtain the reaction mechanism for elementary, heterolytic reactions purely from data about the reactants and products of a reaction. This allows us to train a model on large unannotated reaction datasets such as USPTO \cite{lowe2012extraction}. %To the best of our knowledge our model is the first such model for reaction prediction on end-to-end model for reaction mechanism prediction that is able to learn from reaction datasets unannotated reaction datasets



%Here, we propose ElectronNet, the first end-to-end model to learn sequences of electron shifts directly from large, unannotated reaction datasets \todo{wording not yet elegant here}.